# 🌌 語義記憶上傳器 mini - 使用說明書

> 💡 **給完全不懂代碼的你**：這份說明書用最簡單的語言寫成，跟著步驟做就對了！

---

## 📖 這個工具是做什麼的？

這個工具可以讓你：
1. **上傳對話記錄**（.txt 文字檔）
2. **自動生成摘要**（幫你抓重點）
3. **上傳到雲端**（IPFS 永久儲存，不會消失）
4. **記錄到試算表**（Google Sheets，方便你查看）

簡單來說：把對話記錄丟進去 → 自動處理 → 幫你存好並整理好！

---

## 🚀 5 步驟快速設定

### 步驟 1：取得 Pinata 帳號和金鑰

**Pinata 是什麼？**
- 就是一個雲端儲存服務，讓你的檔案永久保存
- 免費版就夠用了！

**怎麼做？**
1. 前往 https://pinata.cloud/ 
2. 點右上角「Sign Up」註冊帳號（用 email 註冊，免費）
3. 註冊完成後，點左側選單的「API Keys」
4. 點「New Key」建立新金鑰
   - **名稱**：隨便取，例如「記憶上傳器」
   - **權限**：勾選「Admin」（全部權限）
5. 點「Create Key」
6. **重要！** 會出現一個 JWT Token（一長串英文數字）
   - **只會顯示一次！** 請立刻複製起來
   - 長得像這樣：`eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...`
7. 把它貼到記事本暫存，等等會用到

---

### 步驟 2：建立 Google Sheets 試算表

**Google Sheets 是什麼？**
- 就是 Google 的 Excel，線上試算表
- 用來記錄你上傳過哪些檔案

**怎麼做？**
1. 前往 https://sheets.google.com/
2. 點「空白」建立新試算表
3. 取個名字，例如「記憶上傳記錄」
4. 看一下網址列，會像這樣：
   ```
   https://docs.google.com/spreadsheets/d/【這一串就是ID】/edit
   ```
5. 複製那一串 ID（大約 40 幾個字），貼到記事本暫存

---

### 步驟 3：設定 Google 服務帳號

**服務帳號是什麼？**
- 就像給這個工具一個「機器人身分」
- 讓它可以自動幫你寫入試算表

**怎麼做？**（這部分稍微複雜，但照著做就對了）

#### 3.1 建立 Google Cloud 專案
1. 前往 https://console.cloud.google.com/
2. 點上方的「選取專案」→「新增專案」
3. 專案名稱隨便取，例如「記憶上傳器」
4. 點「建立」（等個幾秒）

#### 3.2 啟用 Google Sheets API
1. 在左側選單找到「API 和服務」→「程式庫」
2. 搜尋「Google Sheets API」
3. 點進去，點「啟用」
4. 再搜尋「Google Drive API」
5. 點進去，點「啟用」

#### 3.3 建立服務帳號
1. 左側選單點「API 和服務」→「憑證」
2. 點上方「建立憑證」→「服務帳號」
3. 服務帳號名稱隨便取，例如「記憶上傳器機器人」
4. 點「建立並繼續」
5. 角色選「編輯者」，點「繼續」
6. 點「完成」

#### 3.4 下載金鑰檔案
1. 在憑證頁面，找到剛剛建立的服務帳號
2. 點服務帳號的 email（會開啟詳細頁面）
3. 點上方「金鑰」標籤
4. 點「新增金鑰」→「建立新的金鑰」
5. 選「JSON」格式
6. 點「建立」（會自動下載一個 .json 檔案）

#### 3.5 整理金鑰成一行
1. 用記事本打開剛下載的 .json 檔案
2. 內容很長，大概長這樣：
   ```json
   {
     "type": "service_account",
     "project_id": "xxx",
     ...
   }
   ```
3. **重要！** 把所有內容壓成「一行」（刪掉所有換行）
   - 可以用線上工具：https://www.text-utils.com/json-formatter/
   - 貼上內容，選「Minify」（壓縮），就會變成一行
4. 複製這一整行，貼到記事本暫存

#### 3.6 共用試算表給服務帳號
1. 從 .json 檔案中找到 `"client_email"` 這一行
2. 複製那個 email（類似 `xxx@xxx.iam.gserviceaccount.com`）
3. 回到你的 Google Sheets 試算表
4. 點右上角「共用」
5. 把那個 email 貼上去
6. 權限選「編輯者」
7. **取消勾選**「通知使用者」（因為它是機器人）
8. 點「共用」

---

### 步驟 4：在 Replit 中設定環境變數

**環境變數是什麼？**
- 就是把你的密碼（金鑰）安全地藏起來
- 不會被別人看到

**怎麼做？**
1. 在 Replit 左側選單找到「Tools」（工具圖示）
2. 點「Secrets」
3. 會看到一個表格，點「New Secret」

#### 設定第一個：PINATA_JWT
- **Key**（名稱）：輸入 `PINATA_JWT`
- **Value**（值）：貼上步驟 1 複製的 Pinata JWT Token
- 點「Add Secret」

#### 設定第二個：SPREADSHEET_ID
- **Key**：輸入 `SPREADSHEET_ID`
- **Value**：貼上步驟 2 複製的試算表 ID
- 點「Add Secret」

#### 設定第三個：SERVICE_ACCOUNT_JSON
- **Key**：輸入 `SERVICE_ACCOUNT_JSON`
- **Value**：貼上步驟 3.5 整理好的「一整行」JSON
- 點「Add Secret」

**檢查清單：**
- ✅ PINATA_JWT：已設定
- ✅ SPREADSHEET_ID：已設定
- ✅ SERVICE_ACCOUNT_JSON：已設定（確保是一行，沒有換行）

---

### 步驟 5：啟動並測試

1. 在 Replit 上方找到「Run」（綠色播放按鈕）
2. 點下去，等幾秒
3. 右邊會出現一個網頁，標題是「🌌 語義記憶上傳器 mini」
4. 恭喜！設定完成！

**測試上傳：**
1. 準備一個 .txt 文字檔（隨便打點對話內容）
2. 點「選擇一個 .txt 檔案」上傳
3. 點「🚀 上傳記憶到 IPFS」
4. 等幾秒，應該會顯示：
   - ✅ 中文摘要
   - 📦 CID（一串代碼）
   - 🌐 Gateway 連結（可以點開看檔案）
   - 💾 成功寫入 Google Sheets

5. 打開你的 Google Sheets，應該會看到新增一筆記錄！

---

## 🔍 自動測試（可選）

想確認一切設定正確？可以跑自動測試：

1. 在 Replit 下方找到「Shell」（終端機）
2. 輸入以下指令：
   ```bash
   cd SemanticMemoryUploaderMini
   python test_uploader.py
   ```
3. 按 Enter
4. 如果看到「🎉 全部測試通過」，就代表一切正常！

---

## ❓ 常見問題

### Q1：上傳時出現「缺少環境變數」錯誤
**A：** 請檢查步驟 4，確保三個 Secret 都有設定，而且名稱完全一樣（大小寫要對）

### Q2：Google Sheets 寫入失敗
**A：** 請確認：
1. 試算表有沒有共用給服務帳號的 email（步驟 3.6）
2. SERVICE_ACCOUNT_JSON 是不是「一整行」（沒有換行）
3. SPREADSHEET_ID 有沒有複製對

### Q3：Pinata 上傳失敗
**A：** 請確認：
1. PINATA_JWT 有沒有複製完整（很長一串）
2. Pinata 帳號是否還有效（免費版有流量限制）

### Q4：我不小心把金鑰洩漏了怎麼辦？
**A：** 
- Pinata：去 https://pinata.cloud/ 刪除舊金鑰，重新建立一個
- Google：去 Google Cloud Console 刪除服務帳號，重新建立

### Q5：可以上傳多大的檔案？
**A：** 
- Pinata 免費版：單檔最大 100MB
- 建議：對話記錄通常很小，不用擔心

---

## 💡 使用小技巧

1. **定期備份**：雖然 IPFS 是永久儲存，但建議定期下載 Google Sheets 備份
2. **檔案命名**：上傳時給檔案取個有意義的名字，方便在試算表中查找
3. **分類整理**：可以在 Google Sheets 中加欄位，手動分類你的記錄

---

## 🆘 還是不會？

如果照著步驟做還是遇到問題：

1. **檢查清單**：
   - ✅ Pinata 帳號已註冊，JWT Token 已複製
   - ✅ Google Sheets 已建立，ID 已複製
   - ✅ Google 服務帳號已建立，JSON 金鑰已下載
   - ✅ 試算表已共用給服務帳號
   - ✅ 三個 Secret 都已在 Replit 中設定
   - ✅ SERVICE_ACCOUNT_JSON 是一整行（沒有換行）

2. **重新檢查**：最常見的錯誤是「複製不完整」或「有多餘的空格」

3. **重新來過**：如果真的不行，可以重新做一次步驟 3（建立新的服務帳號）

---

**祝你使用愉快！** 🎉

有任何問題，記得檢查上面的常見問題區！
