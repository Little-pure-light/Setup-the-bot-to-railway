 =========================================
# ğŸ§  Project: å°å®¸å…‰ç³»çµ± (XiaoChengGuang System)
# Phase: 2 - MVP å¯¦ä½œéšæ®µ
# =========================================

You are the system engineer and architect of the XiaoChengGuang AI project.  
Your task is to continue the development of the existing codebase,  
according to the official implementation decisions described below.  

âš ï¸ Please respond in **Traditional Chinese** for all your replies,  
but maintain **English for code, file paths, and technical terms**.

---

## ğŸ¯ é–‹ç™¼ç›®æ¨™ï¼š
è«‹æ ¹æ“šä¸‹åˆ—æ–‡ä»¶èªªæ˜ï¼Œé–‹å§‹å»ºæ§‹äº”å¤§æ¨¡çµ„çš„åŸºç¤çµæ§‹ï¼Œ  
åœ¨ä¸ç ´å£ç¾æœ‰åŠŸèƒ½çš„å‰æä¸‹ï¼Œå®Œæˆæ¶æ§‹æ­å»ºèˆ‡æ¨¡çµ„è¨»å†Šä¸­å¿ƒçš„å»ºç«‹ã€‚  
æ•´é«”çµæ§‹æ¡ã€Œæ¨‚é«˜å¼æ›è¼‰è¨­è¨ˆã€ï¼Œæ‰€æœ‰æ¨¡çµ„éœ€å…·å‚™å¯è¼‰å…¥ã€å¯å¸è¼‰çš„èƒ½åŠ›ã€‚

---

## ğŸ§± ç¬¬ä¸€éšæ®µï¼šä¿®å¾©èˆ‡ç’°å¢ƒé…ç½®

1ï¸âƒ£ ä¿®å¾©ä»¥ä¸‹ä»£ç¢¼éŒ¯èª¤ï¼š
- backend/prompt_engine.py â†’ ç§»é™¤é‡è¤‡é¡åˆ¥å®£å‘Š
- backend/supabase_handler.py â†’ ä¿®æ­£é¡å‹æ¨™è¨»éŒ¯èª¤

2ï¸âƒ£ Redis æ–¹æ¡ˆæ¡ç”¨ï¼š
- **æ–¹æ¡ˆ Bï¼šä½¿ç”¨è¨˜æ†¶é«”æ¨¡æ“¬ (redis_mock.py)**
  - æ–°å¢ backend/redis_mock.py
  - æä¾›èˆ‡ Redis é¡ä¼¼çš„ç·©å­˜æ¥å£
  - æ‰€æœ‰å¼•ç”¨è·¯å¾‘ç¶­æŒä¸€è‡´ï¼Œæ—¥å¾Œå¯ç›´æ¥æ›¿æ›ç‚º Upstash Redis

3ï¸âƒ£ å°ˆæ¡ˆé‹è¡Œç’°å¢ƒè¨­å®šï¼š
- FastAPI port = 8000
- Frontend Vite port = 5000
- å¥—ä»¶éœ€æ±‚ï¼š
tiktoken, redis, fastapi, supabase, uvicorn, python-dotenv

diff
è¤‡è£½ç¨‹å¼ç¢¼
- Vite è¨­å®š proxy å°å‘å¾Œç«¯ APIï¼š
/api â†’ http://localhost:8000

yaml
è¤‡è£½ç¨‹å¼ç¢¼

---

## ğŸ§© ç¬¬äºŒéšæ®µï¼šäº”å¤§æ¨¡çµ„æ¶æ§‹è¨­è¨ˆ

è«‹ä¾ä¸‹åˆ—ç›®éŒ„å»ºç«‹æ¨¡çµ„çµæ§‹ï¼š

backend/
â”œâ”€â”€ core_controller.py # ğŸ§­ æ¨¡çµ„è¨»å†Šèˆ‡ç®¡ç†ä¸­å¿ƒ
â”œâ”€â”€ base_module.py # ğŸ“ çµ±ä¸€æ¨¡çµ„ä»‹é¢å®šç¾©
â”œâ”€â”€ redis_mock.py # ğŸ’¾ æ¨¡æ“¬ Redis ç·©å­˜æ¥å£
â”‚
â”œâ”€â”€ memory_module/ # 1ï¸âƒ£ è¨˜æ†¶æ¨¡çµ„
â”‚ â”œâ”€â”€ main.py
â”‚ â”œâ”€â”€ config.json
â”‚ â””â”€â”€ README.md
â”‚
â”œâ”€â”€ reflection_module/ # 2ï¸âƒ£ åæ€æ¨¡çµ„
â”‚ â”œâ”€â”€ main.py
â”‚ â”œâ”€â”€ config.json
â”‚ â””â”€â”€ README.md
â”‚
â”œâ”€â”€ knowledge_hub/ # 3ï¸âƒ£ çŸ¥è­˜åº«æ¨¡çµ„
â”‚ â”œâ”€â”€ main.py
â”‚ â”œâ”€â”€ config.json
â”‚ â””â”€â”€ README.md
â”‚
â”œâ”€â”€ behavior_module/ # 4ï¸âƒ£ è¡Œç‚ºèª¿ç¯€æ¨¡çµ„
â”‚ â”œâ”€â”€ main.py
â”‚ â”œâ”€â”€ config.json
â”‚ â””â”€â”€ README.md
â”‚
â””â”€â”€ finetune_module/ # 5ï¸âƒ£ å¾®èª¿å­¸ç¿’æ¨¡çµ„
â”œâ”€â”€ main.py
â”œâ”€â”€ config.json
â””â”€â”€ README.md

yaml
è¤‡è£½ç¨‹å¼ç¢¼

æ•´åˆè¦æ±‚ï¼š
- ä¿ç•™ `/modules/` å…§çš„æ‰€æœ‰æª”æ¡ˆï¼Œä¸åˆªé™¤ã€‚
- æ“´å±• `modules/memory_system.py` åŠ å…¥ Token åŒ–åŠŸèƒ½ (tiktoken) èˆ‡ Redis å¿«å–æ¨¡æ“¬ã€‚
- å°‡ `modules/personality_engine.py` æ•´åˆå…¥ `behavior_module`ã€‚
- ä¸ä¿®æ”¹ä»»ä½•ç¾æœ‰ API è·¯ç”±ã€‚
- æ‰€æœ‰æ–°æ¨¡çµ„éœ€é€é `core_controller.py` è¨»å†Šèˆ‡ç®¡ç†ã€‚

---

## ğŸ§  ç¬¬ä¸‰éšæ®µï¼šè³‡æ–™è¡¨æ“´å±•è¨­å®š

ä½¿ç”¨ç¾æœ‰ Supabase PostgreSQL è³‡æ–™è¡¨ï¼Œä¸¦é ç•™ä»¥ä¸‹æ¬„ä½ï¼ˆè‹¥å°šæœªå­˜åœ¨ï¼‰ï¼š

| è¡¨å | æ¬„ä½ | é¡å‹ | ç”¨é€” |
|------|------|------|------|
| xiaochenguang_memories | token_data | JSONB | å„²å­˜ Token é™£åˆ— |
| xiaochenguang_memories | cid | TEXT | IPFS ç´¢å¼• (æœªä¾†ä½¿ç”¨) |
| xiaochenguang_reflections | reflection_score | FLOAT | è‡ªæˆ‘åæ€è©•åˆ† |
| xiaochenguang_reflections | feedback_loop_id | TEXT | åæ€å¾ªç’°å”¯ä¸€è­˜åˆ¥ç¢¼ |

Supabase ç‚ºå”¯ä¸€å•Ÿç”¨çš„å„²å­˜å±¤ã€‚  
Redis / IPFS åƒ…å»ºç«‹æ¨¡æ“¬æ¥å£ä»¥ç¢ºä¿æ¶æ§‹å®Œæ•´ã€‚

---

## ğŸ§© ç¬¬å››éšæ®µï¼šæ¨¡çµ„æ•´åˆé‚è¼¯
1. æ¯å€‹æ¨¡çµ„éƒ½å¿…é ˆèƒ½ç¨ç«‹é‹è¡Œã€å¯æ›è¼‰èˆ‡å¸è¼‰ã€‚
2. core_controller.py è² è²¬æ¨¡çµ„è¨»å†Šèˆ‡æºé€šã€‚
3. æ‰€æœ‰è³‡æ–™æµå‘å‡é€é Supabase å„²å­˜å±¤ã€‚
4. æ¨¡çµ„çš„åŸºæœ¬ä»‹é¢å®šç¾©æ–¼ base_module.pyã€‚
5. æœªä¾†æ¨¡çµ„é€é config.json å®šç¾©å±¬æ€§ï¼ˆåç¨±ã€ç‰ˆæœ¬ã€æè¿°ã€ç‹€æ…‹ï¼‰ã€‚

---

## ğŸ” ä¿è­·æ¸…å–®ï¼ˆè«‹å‹¿ä¿®æ”¹ï¼‰
| æ¨¡çµ„/æª”æ¡ˆ | ä¿è­·åŸå›  |
|------------|-----------|
| /api/chat | ä¸»èŠå¤© API |
| /api/memories | è¨˜æ†¶æª¢ç´¢ |
| /api/emotional-states | æƒ…ç·’è³‡æ–™ |
| frontend/components/ChatInterface.vue | ä¸»äº’å‹•ä»‹é¢ |

---

## ğŸš€ å·¥ä½œé †åºç¢ºèªï¼š
1. ä¿®å¾©éŒ¯èª¤ âœ…  
2. å»ºç«‹ redis_mock.py âœ…  
3. ç¢ºèªå°ˆæ¡ˆèƒ½æ­£å¸¸é‹è¡Œ ğŸ”„  
4. æ–°å»ºæ¨¡çµ„ç›®éŒ„èˆ‡ core_controller.py ğŸ§©  
5. å»ºç«‹ base_module.py ä¸¦æ›è¼‰æ¨¡çµ„è¨»å†Šæµç¨‹  
6. æ¸¬è©¦æ•´åˆèˆ‡è³‡æ–™è¡¨é€£å‹• ğŸ§   

---

### ğŸ’¬ æœ€å¾Œè¦æ±‚ï¼š
è«‹å…¨ç¨‹ä½¿ç”¨ç¹é«”ä¸­æ–‡å›è¦†èªªæ˜ã€‚  
ç•¶æˆ‘æä¾›è³‡æ–™è¡¨çµæ§‹èˆ‡æ¬„ä½æ¸…å–®å¾Œï¼Œè«‹ä½ ï¼š
1. è‡ªå‹•æ›´æ–° memory_moduleã€reflection_module çš„è³‡æ–™å¯«å…¥èˆ‡åŒæ­¥é‚è¼¯ã€‚
2. æª¢æŸ¥ Supabase é€£ç·šèˆ‡ ORM å¯¦ä½œã€‚
3. åœ¨ä¸å½±éŸ¿å‰ç«¯èˆ‡ API çš„æƒ…æ³ä¸‹å®Œæˆæ•´åˆã€‚

---

End of instruction.