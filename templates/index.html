<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èªç¾©è¨˜æ†¶ç®¡ç†ç³»çµ±</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <header>
            <h1>ğŸ§  èªç¾©è¨˜æ†¶ç®¡ç†ç³»çµ±</h1>
            <p class="subtitle">AI å°è©±å»¶çºŒèˆ‡è¨˜æ†¶æ‡‰ç”¨</p>
        </header>

        <div class="status-box">
            {% if current_sheet %}
                <div class="status-active">
                    <strong>ç›®å‰ä½¿ç”¨çš„è¨˜éŒ„æœ¬ï¼š</strong>
                    <span class="sheet-name">{{ current_sheet }}</span>
                </div>
            {% else %}
                <div class="status-inactive">
                    <strong>ç‹€æ…‹ï¼š</strong>å°šæœªå•Ÿå‹•ä»»ä½•å°è©±
                </div>
            {% endif %}
        </div>

        <div class="actions">
            <div class="action-card">
                <h2>ğŸ†• å»ºç«‹æ–°å°è©±</h2>
                <p>å»ºç«‹ä¸€å€‹å…¨æ–°çš„å°è©±è¨˜éŒ„æœ¬</p>
                <form id="newConversationForm">
                    <input type="text" id="newSheetName" name="sheet_name" 
                           placeholder="è¼¸å…¥å°è©±åç¨±ï¼ˆä¾‹å¦‚ï¼šå°ˆæ¡ˆè¨è«–_2024ï¼‰" required>
                    <button type="submit" class="btn btn-primary">å»ºç«‹æ–°å°è©±</button>
                </form>
                <div id="newConversationUrl" class="url-display"></div>
            </div>

            <div class="action-card">
                <h2>ğŸ“– å»¶çºŒå·²æœ‰å°è©±</h2>
                <p>è¼‰å…¥ä¸¦ç¹¼çºŒä¹‹å‰çš„å°è©±è¨˜éŒ„</p>
                <form id="resumeConversationForm">
                    <input type="text" id="resumeSheetName" name="sheet_name" 
                           placeholder="è¼¸å…¥ç¾æœ‰å°è©±åç¨±" required>
                    <button type="submit" class="btn btn-success">å»¶çºŒå°è©±</button>
                </form>
                <div id="resumeConversationUrl" class="url-display"></div>
            </div>
        </div>

        <div class="info-section">
            <h3>ğŸ“š ä½¿ç”¨èªªæ˜</h3>
            <ul>
                <li><strong>å»ºç«‹æ–°å°è©±ï¼š</strong>è¼¸å…¥ä¸€å€‹æ–°çš„å°è©±åç¨±ï¼Œç³»çµ±æœƒåœ¨ Google Sheets ä¸­å»ºç«‹æ–°çš„å·¥ä½œè¡¨</li>
                <li><strong>å»¶çºŒå·²æœ‰å°è©±ï¼š</strong>è¼¸å…¥å·²å­˜åœ¨çš„å°è©±åç¨±ï¼Œç³»çµ±æœƒè¼‰å…¥è©²å·¥ä½œè¡¨çš„æ­·å²è¨˜éŒ„</li>
                <li><strong>API ç«¯é»ï¼š</strong>
                    <ul>
                        <li><code>POST /log</code> - è¨˜éŒ„å°è©±å…§å®¹</li>
                        <li><code>GET /get_history?sheet_name=åç¨±&limit=5</code> - æŸ¥è©¢æ­·å²è¨˜éŒ„</li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>

    <script>
        document.getElementById('newConversationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const sheetName = document.getElementById('newSheetName').value.trim();
            if (sheetName) {
                const url = `${window.location.origin}/start?mode=new&sheet_name=${encodeURIComponent(sheetName)}`;
                window.location.href = url;
            }
        });

        document.getElementById('resumeConversationForm').addEventListener('submit', function(e) {
            e.preventDefault();
            const sheetName = document.getElementById('resumeSheetName').value.trim();
            if (sheetName) {
                const url = `${window.location.origin}/start?mode=resume&sheet_name=${encodeURIComponent(sheetName)}`;
                window.location.href = url;
            }
        });
    </script>
</body>
</html>
